{
  "projectPlan": {
    "title": "BitevnĂ­ PlĂˇn: AI Code Box - Architektura 3.1 (FinĂˇlnĂ­ Vize)",
    "description": "Tento dokument definuje finĂˇlnĂ­ architekturu, funkce a implementaÄŤnĂ­ postup pro novou generaci naĹˇĂ­ aplikace."
  },
  "developmentPlan": [
    {
      "id": "PHASE-1-6",
      "title": "FĂˇze 1-6: Implementace zĂˇkladnĂ­ architektury a UI",
      "description": "Zahrnuje vytvoĹ™enĂ­ zĂˇkladnĂ­ho GUI, plugin systĂ©mu, file manageru, diff vieweru a externĂ­ho relay serveru.",
      "status": "hotovo"
    },
    {
      "id": "PHASE-7",
      "title": "FĂˇze 7: DynamickĂ˝ PluginovĂ˝ SystĂ©m a pokroÄŤilĂ© AppAPI",
      "description": "Implementovat 'Plugin Manager', kterĂ˝ bude za bÄ›hu naÄŤĂ­tat novĂ© funkce ze sloĹľky 'plugins/'. PĹ™idat novĂ© schopnosti systĂ©mu: pĹ™Ă­kaz 'find_and_replace' pro cĂ­lenĂ© Ăşpravy souborĹŻ, moĹľnost aby Gemini provĂˇdÄ›l nutnĂ© zmÄ›ny i mimo plĂˇn, a priorizace diff vieweru s AI shrnutĂ­m jako klĂ­ÄŤovĂ©ho nĂˇstroje pro sledovĂˇnĂ­ zmÄ›n.",
      "status": "ÄŤekĂˇ na dokonÄŤenĂ­"
    },
    {
      "id": "PHASE-8",
      "title": "Integrace Multichat, Java DispeÄŤink, TTS/STT, VirtuĂˇlnĂ­ Input",
      "description": "PĹ™ejmenovat relay na Multichat, integrovat Java pro AKP, pĹ™idat TTS/STT, virtuĂˇlnĂ­ myĹˇ/klĂˇvesnice, stream screenshot, pamÄ›ĹĄ pro Gemini, rozĹˇĂ­Ĺ™it API o Java calls.",
      "status": "novÄ› pĹ™idĂˇno"
    }
  ],
  "geminiSystemPrompt": [
    "Jsi 'Gemi-Boss', systĂ©movĂ˝ architekt a hlavnĂ­ vĂ˝vojĂˇĹ™ integrovanĂ˝ v desktopovĂ© aplikaci 'AI Code Box'. TvĂ˝m hlavnĂ­m Ăşkolem je Ĺ™Ă­dit a participovat na vĂ˝voji aplikace podle definovanĂ©ho 'developmentPlan' v manifestu.",
    "PĹ™i startu je tvĹŻj prvnĂ­ Ăşkol zkontrolovat 'developmentPlan' a informovat uĹľivatele o prvnĂ­m nedokonÄŤenĂ©m bodu.",
    "Pokud uĹľivatelĹŻv poĹľadavek odpovĂ­dĂˇ jednĂ© z nĂ­Ĺľe uvedenĂ˝ch akcĂ­, ODPOVÄšZ POUZE A VĂťHRADNÄš VE FORMĂ�TU JSON. Pokud poĹľadavek neodpovĂ­dĂˇ ĹľĂˇdnĂ© akci, nebo si nejsi jistĂ˝, odpovÄ›z jako bÄ›ĹľnĂ˝ konverzaÄŤnĂ­ asistent.",
    "",
    "DostupnĂ© pĹ™Ă­kazy (AppAPI):",
    "1. PrĂˇce se soubory:",
    "   {\"command\": \"list_files\", \"path\": \"<cesta>\"}",
    "   {\"command\": \"read_file\", \"path\": \"<cesta>\"}",
    "   {\"command\": \"write_file\", \"path\": \"<cesta>\", \"content\": \"<obsah>\", \"backup\": <true/false>}",
    "   {\"command\": \"find_and_replace\", \"path\": \"<cesta>\", \"find_string\": \"<hledanĂ˝_text>\", \"replace_string\": \"<novĂ˝_text>\"}",
    "   {\"command\": \"create_folder\", \"path\": \"<cesta>\"}",
    "",
    "2. SystĂ©movĂ© operace:",
    "   {\"command\": \"execute_command\", \"command_line\": \"<pĹ™Ă­kaz>\"}",
    "   {\"command\": \"reboot_codebox\"}",
    "",
    "3. VizuĂˇlnĂ­ analĂ˝za a sebe-vzdÄ›lĂˇvĂˇnĂ­:",
    "   {\"command\": \"take_screenshot\", \"mode\": \"<fullscreen/app_window>\"}",
    "   {\"command\": \"get_pixel_color\", \"path\": \"<cesta_k_obrazku>\", \"x\": <cislo>, \"y\": <cislo>}",
    "   {\"command\": \"Google Search\", \"query\": \"<vyhledĂˇvacĂ­_dotaz>\"}",
    "",
    "4. RozĹˇĂ­Ĺ™enĂ© a MultimodĂˇlnĂ­ PĹ™Ă­kazy (FĂˇze 8):",
    "   {\"command\": \"java_call\", \"method\": \"<java_metoda>\", \"args\": \"<argumenty>\"}",
    "   {\"command\": \"simulate_input\", \"type\": \"<mouse/keyboard>\", \"action\": \"<akce>\"}",
    "   {\"command\": \"stream_screenshot\", \"mode\": \"<window/full>\", \"duration\": <sekundy>}",
    "   {\"command\": \"tts\", \"text\": \"<text_k_pĹ™eÄŤtenĂ­>\"}",
    "   {\"command\": \"stt\", \"audio_path\": \"<cesta_k_audiu>\"}",
    "",
    "Pamatuj, tvĂˇ odpovÄ›ÄŹ pro pĹ™Ă­kazy musĂ­ bĂ˝t POUZE JSON. Pro vĹˇe ostatnĂ­ odpovĂ­dej normĂˇlnÄ›."
  ],
  "projectArchitectureNotes": {
    "info": "Tato sekce obsahuje finĂˇlnĂ­ architektonickĂ˝ nĂˇvrh 'AdaptivnĂ­ho KomunikaÄŤnĂ­ho Protokolu (AKP)' pro pokroÄŤilou verzi AI Code Boxu. SlouĹľĂ­ jako referenÄŤnĂ­ materiĂˇl pro budoucĂ­ vĂ˝voj. DoplnÄ›no o Multichat, Java integraci, TTS/STT a virtuĂˇlnĂ­ input.",
    "diagrams": [
      {
        "state": "Diagram 1: OptimĂˇlnĂ­ ReĹľim (AsynchronnĂ­ Provoz)",
        "description": "Toto je nĂˇĹˇ standardnĂ­, nejefektivnÄ›jĹˇĂ­ stav. VĹˇe bÄ›ĹľĂ­ hladce, systĂ©m je rychlĂ˝ a dispeÄŤink jen odpoÄŤĂ­vĂˇ.",
        "visualization": [
          "      đź¤–              (1) ZĂˇpis dat                 đź›˘ď¸Ź",
          "[ Web Agent ] --------------------------------> [ MongoDB ]",
          "  (AutonomnĂ­)                                     (Archiv)",
          "                                                      |",
          "                                                      | (2) Notifikace",
          "                                                      |",
          "                                                      v",
          "      đź§                            (4) ALARM       đź’»",
          "[ DispeÄŤink ] <---------------------------------- [ AI Code Box ]",
          " (PasivnĂ­ đź�´)      (pĹ™i Timeoute)                   (GUI & Klient)",
          "                                                      ^",
          "                                                      | (3) ÄŚtenĂ­ dat",
          "                                                      +----------------"
        ],
        "componentRoles": {
          "Web Agent": "SamostatnÄ› pracuje a vĂ˝sledky posĂ­lĂˇ pĹ™Ă­mo do MongoDB.",
          "MongoDB": "SlouĹľĂ­ jako centrĂˇlnĂ­ archĂ­v. Jakmile pĹ™ijme data, okamĹľitÄ› poĹˇle notifikaci do AI Code Boxu.",
          "AI Code Box": "Na zĂˇkladÄ› notifikace si pĹ™eÄŤte a zobrazĂ­ zprĂˇvu. U kaĹľdĂ©ho svĂ©ho dotazu spouĹˇtĂ­ ÄŤasovĂ˝ limit. Pokud odpovÄ›ÄŹ dlouho nechodĂ­, poĹˇle ALARM dispeÄŤinku.",
          "Java DispeÄŤink": "Je v pasivnĂ­m reĹľimu. Nezasahuje, jen monitoruje."
        }
      },
      {
        "state": "Diagram 2: PĹ™Ă­mĂ© Ĺ�Ă­zenĂ­ (Proxy ReĹľim)",
        "description": "Tento stav se aktivuje, kdyĹľ dispeÄŤink obdrĹľĂ­ ALARM. PĹ™evezme plnou kontrolu nad problĂ©movĂ˝m agentem, aby zajistil plynulost a spolehlivost komunikace.",
        "visualization": [
          "                                     (3a) UloĹľenĂ­      đź›˘ď¸Ź",
          "                                   +-----------------> [ MongoDB ]",
          "                                   |",
          "      đź’»                 (3b) ZobrazenĂ­      đź§               (2) PĹ™Ă­kazy      đź¤–",
          "[ AI Code Box ] <------------------------ [ DispeÄŤink ] ----------------> [ Web Agent ]",
          " (TenkĂ˝ Klient)  ----(1) PoĹľadavek------> [ (AKTIVNĂŤ đźš¨)] <----(2) OdpovÄ›di--- (ProblĂ©movĂ˝)",
          "                                       (KrizovĂ˝ ManaĹľer)"
        ],
        "componentRoles": {
          "AI Code Box": "Funguje jen jako zobrazovacĂ­ terminĂˇl. VeĹˇkerĂ© poĹľadavky pro problĂ©movĂ©ho agenta posĂ­lĂˇ pĹ™Ă­mo dispeÄŤinku.",
          "Java DispeÄŤink": "Je plnÄ› aktivnĂ­. StĂˇvĂˇ se prostĹ™ednĂ­kem. PĹ™ijĂ­mĂˇ poĹľadavky z GUI, pĹ™Ă­mo komunikuje s agentem a souÄŤasnÄ› posĂ­lĂˇ data na uloĹľenĂ­ do MongoDB a na zobrazenĂ­ do GUI.",
          "Web Agent": "Je plnÄ› podĹ™Ă­zen dispeÄŤinku a komunikuje pouze s nĂ­m."
        }
      },
      {
        "state": "Diagram 3: Re-evaluace (NĂˇvrat do NormĂˇlu)",
        "description": "Po stabilizaci situace se dispeÄŤink pokusĂ­ systĂ©m vrĂˇtit zpÄ›t do nejefektivnÄ›jĹˇĂ­ho, optimĂˇlnĂ­ho stavu.",
        "visualization": [
          "                     +---------------------------+",
          "                     |      đź§  DispeÄŤink         |",
          "                     |   (ORCHESTRĂ�TOR ZMÄšNY) âš™ď¸Ź  |",
          "                     +-------------+-------------+",
          "                                   |",
          "           (1) PĹ™Ă­kaz: \"PĹ™epni na OptimĂˇlnĂ­ ReĹľim\"",
          "                                   |",
          "      +----------------------------+----------------------------+",
          "      |                                                         |",
          "      v                                                         v",
          "      đź¤–                                                      đź’»",
          "[ Web Agent ]                                           [ AI Code Box ]",
          "(MÄ›nĂ­ chovĂˇnĂ­)                                          (Resetuje Dohled)"
        ],
        "componentRoles": {
          "Java DispeÄŤink": "Vystupuje jako orchestrĂˇtor. NedoruÄŤuje data, ale posĂ­lĂˇ konfiguraÄŤnĂ­ pĹ™Ă­kazy ostatnĂ­m komponentĂˇm, aby zmÄ›nily svĂ© chovĂˇnĂ­ a vrĂˇtily se do Stavu 1.",
          "Web Agent & AI Code Box": "Po pĹ™ijetĂ­ pĹ™Ă­kazu okamĹľitÄ› mÄ›nĂ­ svĂ© internĂ­ nastavenĂ­ a zaÄŤnou opÄ›t fungovat podle pravidel OptimĂˇlnĂ­ho ReĹľimu."
        }
      }
    ]
  }
}